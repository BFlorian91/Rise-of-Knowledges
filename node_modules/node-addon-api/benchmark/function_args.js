const path = require('path');
const Benchmark = require('benchmark');
const addonName = path.basename(__filename, '.js');

[ addonName, addonName + '_noexcept' ]
  .forEach((addonName) => {
<<<<<<< HEAD
    const rootAddon = require(`./build/Release/${addonName}`);
    const implems = Object.keys(rootAddon);
    const anObject = {};

    console.log(`${addonName}: `);
=======
    const rootAddon = require('bindings')({
      bindings: addonName,
      module_root: __dirname
    });
    delete rootAddon.path;
    const implems = Object.keys(rootAddon);
    const maxNameLength =
      implems.reduce((soFar, value) => Math.max(soFar, value.length), 0);
    const anObject = {};

    console.log(`\n${addonName}: `);
>>>>>>> dfa9614089c24b76da4727b2e44fbea7c977b744

    console.log('no arguments:');
    implems.reduce((suite, implem) => {
      const fn = rootAddon[implem].noArgFunction;
<<<<<<< HEAD
      return suite.add(implem, () => fn());
=======
      return suite.add(implem.padStart(maxNameLength, ' '), () => fn());
>>>>>>> dfa9614089c24b76da4727b2e44fbea7c977b744
    }, new Benchmark.Suite)
      .on('cycle', (event) => console.log(String(event.target)))
      .run();

    console.log('one argument:');
    implems.reduce((suite, implem) => {
      const fn = rootAddon[implem].oneArgFunction;
<<<<<<< HEAD
      return suite.add(implem, () => fn('x'));
=======
      return suite.add(implem.padStart(maxNameLength, ' '), () => fn('x'));
>>>>>>> dfa9614089c24b76da4727b2e44fbea7c977b744
    }, new Benchmark.Suite)
      .on('cycle', (event) => console.log(String(event.target)))
      .run();

    console.log('two arguments:');
    implems.reduce((suite, implem) => {
      const fn = rootAddon[implem].twoArgFunction;
<<<<<<< HEAD
      return suite.add(implem, () => fn('x', 12));
=======
      return suite.add(implem.padStart(maxNameLength, ' '), () => fn('x', 12));
>>>>>>> dfa9614089c24b76da4727b2e44fbea7c977b744
    }, new Benchmark.Suite)
      .on('cycle', (event) => console.log(String(event.target)))
      .run();

    console.log('three arguments:');
    implems.reduce((suite, implem) => {
      const fn = rootAddon[implem].threeArgFunction;
<<<<<<< HEAD
      return suite.add(implem, () => fn('x', 12, true));
=======
      return suite.add(implem.padStart(maxNameLength, ' '),
        () => fn('x', 12, true));
>>>>>>> dfa9614089c24b76da4727b2e44fbea7c977b744
    }, new Benchmark.Suite)
      .on('cycle', (event) => console.log(String(event.target)))
      .run();

    console.log('four arguments:');
    implems.reduce((suite, implem) => {
      const fn = rootAddon[implem].fourArgFunction;
<<<<<<< HEAD
      return suite.add(implem, () => fn('x', 12, true, anObject));
=======
      return suite.add(implem.padStart(maxNameLength, ' '),
        () => fn('x', 12, true, anObject));
>>>>>>> dfa9614089c24b76da4727b2e44fbea7c977b744
    }, new Benchmark.Suite)
      .on('cycle', (event) => console.log(String(event.target)))
      .run();
  });
